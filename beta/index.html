<!doctype html>
<html lang="en">
    <head>
        <script src="scripts/mapgen.js"></script>
        <script src="scripts/settings.js"></script>
        <script src="scripts/mapview.js"></script>
        <link href="styles/site.css" rel="stylesheet" />
        <link href="styles/maps.css" rel="stylesheet" />
        <link href="styles/navigation.css" rel="stylesheet" />
        <link href="styles/history.css" rel="stylesheet" />
        <script>
            window.addEventListener('load', () => {
                const setting = document.querySelector('h-settings');
                setting.registerSettings(new Settings());

                const editor = new MapEditView(document.querySelector("#editor-map"))
                const practicer = new MapPracticeView(document.querySelector("#practice-map"));
                
                const practiceMapTab = document.querySelector("#map-practice-tab");
                const editMapTab = document.querySelector("#map-editor-tab");
                
                editor.on("map", ({ map }) => {
                    practicer.setMap(MapGenerator.shift(map));
                    practiceMapTab.checked = true;
                })

                practicer.on("edit", ({ map }) => {
                    editor.setMap(MapGenerator.unshift(map));
                    editMapTab.checked = true;
                })

                const history = new MapHistoryView(practicer.history, document.querySelector("#map-history"))
            })
        </script>
    </head>
    <body>
        <!-- I'm not gonna lie I stole this navigation from https://codepen.io/MPDoctor/pen/mpJdYe -->
        <div class="tab-navigation">
            <input type="radio" id="map-practice-tab" name="tab-radio" checked>
            <input type="radio" id="map-history-tab" name="tab-radio">
            <input type="radio" id="map-editor-tab" name="tab-radio">
            <input type="radio" id="settings-tab" name="tab-radio">
            <ul class="tab-header">
                <li class="tab"><label for="map-practice-tab">Map Practice</label></li>
                <li class="tab"><label for="map-history-tab">Map History</label></li>
                <li class="tab"><label for="map-editor-tab">Map Editor</label></li>
                <li class="tab"><label for="settings-tab">Settings</label></li>
            </ul>
            <div class="tab-content">
                <div class="map-view" id="practice-map">
                    <div class="wrapper">
                        <canvas width="1800" height="1800"></canvas>
                    </div>
                    <div class="panel">
                        <div class="controls">
                            <button type="button" id="newMap">ğŸ”„</button>
                            <button type="button" id="undoMove">â†©ï¸</button>
                            <button type="button" id="unveilMap">ğŸ‘ï¸</button>
                            <button type="button" id="screenshotMap">ğŸ“¸</button>
                            <button type="button" id="shareMap">ğŸ¤</button>
                            <button type="button" id="openEdit">ğŸ“</button>
                            <input type="checkbox" id="favoriteMap" style="display: none">
                            <label for="favoriteMap">â­</label>
                        </div>
                        <div class="stats">
                            <div>
                                <h2>Session Stats</h2>
                                <div><div>Pots:</div><div class="stat" id="sessionPots">0</div></div>
                                <div><div>Defenders:</div><div class="stat" id="sessionDefenders">0</div></div>
                                <div><div>Pot Ratio:</div><div class="stat" id="sessionRatio">No Defenders</div></div>
                            </div>
                            <div>
                                <h2>All Time Stats</h2>
                                <div><div>Pots:</div><div class="stat" id="lifetimePots">0</div></div>
                                <div><div>Defenders:</div><div class="stat" id="lifetimeDefenders">0</div></div>
                                <div><div>Pot Ratio:</div><div class="stat" id="lifetimeRatio">No Defenders</div></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="tab-content" id="map-history">
                
            </div>
            <div class="tab-content">
                <div class="map-view" id="editor-map">
                    <div class="wrapper">
                        <canvas width="1800" height="1800"></canvas>
                    </div>
                    <div class="controls">
                        <button type="button" id="reset">ğŸ”„</button>
                        <button type="button" id="toggleUp">â¬†ï¸</button>
                        <button type="button" id="toggleDown">â¬‡ï¸</button>
                        <button type="button" id="toggleLeft">â¬…ï¸</button>
                        <button type="button" id="toggleRight">â¡ï¸</button>
                        <button type="button" id="setDefender">ğŸ›¡ï¸</button>
                        <button type="button" id="deleteRooms">ğŸ—‘ï¸</button>
                        <button type="button" id="mapLink">ğŸ†—</button>
                        <a id="showInBrowser" target="_blank">ğŸ¤</a>
                    </div>
                </div>
            </div>
            <div class="tab-content">
                <h-settings></h-settings>
            </div>
        </div>
    </body>
</html>